<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Twitch.js documentation</title>
    <link rel="stylesheet" href="/twitch-pubsub-client/static/css/style.css" />
</head>
<body>
<div id="root"><div class="App"><div class="NavMenu"><a class="NavMenuItem" href="/twitch-pubsub-client/">Welcome</a><div class="NavMenuGroup"><h2 class="NavMenuGroup__title">Basic usage</h2><div class="NavMenuGroup__items"><a class="NavMenuItem" title="Getting started" href="/twitch-pubsub-client/docs/basic-usage/getting-started.html">Getting started</a><a class="NavMenuItem" title="Listening to a single channel" href="/twitch-pubsub-client/docs/basic-usage/listening-to-single-channel.html">Listening to a single channel</a></div></div><div class="NavMenuGroup"><h2 class="NavMenuGroup__title">Low level usage</h2><div class="NavMenuGroup__items"><a class="NavMenuItem NavMenuItem--active" aria-current="page" title="One client, multiple channels" href="/twitch-pubsub-client/docs/low-level/one-client-multiple-channels.html">One client, multiple channels</a></div></div><div class="NavMenuGroup"><h2 class="NavMenuGroup__title">Classes</h2><div class="NavMenuGroup__items"><a class="NavMenuItem" title="PubSubBitsMessage" href="/twitch-pubsub-client/reference/classes/PubSubBitsMessage.html">PubSubBitsMessage</a><a class="NavMenuItem" title="PubSubClient" href="/twitch-pubsub-client/reference/classes/PubSubClient.html">PubSubClient</a><a class="NavMenuItem" title="PubSubCommerceMessage" href="/twitch-pubsub-client/reference/classes/PubSubCommerceMessage.html">PubSubCommerceMessage</a><a class="NavMenuItem" title="PubSubListener" href="/twitch-pubsub-client/reference/classes/PubSubListener.html">PubSubListener</a><a class="NavMenuItem" title="PubSubSubscriptionMessage" href="/twitch-pubsub-client/reference/classes/PubSubSubscriptionMessage.html">PubSubSubscriptionMessage</a><a class="NavMenuItem" title="PubSubWhisperMessage" href="/twitch-pubsub-client/reference/classes/PubSubWhisperMessage.html">PubSubWhisperMessage</a><a class="NavMenuItem" title="SingleUserPubSubClient" href="/twitch-pubsub-client/reference/classes/SingleUserPubSubClient.html">SingleUserPubSubClient</a></div></div><div class="NavMenuGroup"><h2 class="NavMenuGroup__title">Interfaces</h2><div class="NavMenuGroup__items"><a class="NavMenuItem" title="PubSubBasicMessageInfo" href="/twitch-pubsub-client/reference/interfaces/PubSubBasicMessageInfo.html">PubSubBasicMessageInfo</a><a class="NavMenuItem" title="PubSubBitsMessageBadgeEntitlement" href="/twitch-pubsub-client/reference/interfaces/PubSubBitsMessageBadgeEntitlement.html">PubSubBitsMessageBadgeEntitlement</a><a class="NavMenuItem" title="PubSubBitsMessageContent" href="/twitch-pubsub-client/reference/interfaces/PubSubBitsMessageContent.html">PubSubBitsMessageContent</a><a class="NavMenuItem" title="PubSubBitsMessageData" href="/twitch-pubsub-client/reference/interfaces/PubSubBitsMessageData.html">PubSubBitsMessageData</a><a class="NavMenuItem" title="PubSubChatMessage" href="/twitch-pubsub-client/reference/interfaces/PubSubChatMessage.html">PubSubChatMessage</a><a class="NavMenuItem" title="PubSubChatMessageBadge" href="/twitch-pubsub-client/reference/interfaces/PubSubChatMessageBadge.html">PubSubChatMessageBadge</a><a class="NavMenuItem" title="PubSubChatMessageEmote" href="/twitch-pubsub-client/reference/interfaces/PubSubChatMessageEmote.html">PubSubChatMessageEmote</a><a class="NavMenuItem" title="PubSubCommerceMessageData" href="/twitch-pubsub-client/reference/interfaces/PubSubCommerceMessageData.html">PubSubCommerceMessageData</a><a class="NavMenuItem" title="PubSubSubscriptionDetail" href="/twitch-pubsub-client/reference/interfaces/PubSubSubscriptionDetail.html">PubSubSubscriptionDetail</a><a class="NavMenuItem" title="PubSubSubscriptionGiftDetail" href="/twitch-pubsub-client/reference/interfaces/PubSubSubscriptionGiftDetail.html">PubSubSubscriptionGiftDetail</a><a class="NavMenuItem" title="PubSubWhisperMessageContent" href="/twitch-pubsub-client/reference/interfaces/PubSubWhisperMessageContent.html">PubSubWhisperMessageContent</a><a class="NavMenuItem" title="PubSubWhisperMessageData" href="/twitch-pubsub-client/reference/interfaces/PubSubWhisperMessageData.html">PubSubWhisperMessageData</a><a class="NavMenuItem" title="PubSubWhisperRecipient" href="/twitch-pubsub-client/reference/interfaces/PubSubWhisperRecipient.html">PubSubWhisperRecipient</a><a class="NavMenuItem" title="PubSubWhisperTags" href="/twitch-pubsub-client/reference/interfaces/PubSubWhisperTags.html">PubSubWhisperTags</a></div></div></div><div class="App__main"><main class="App__content"><div class="PageHeader"><h1>One client, multiple channels</h1></div><div class="PageContent"><p>If you want to listen to events on different channels with just one PubSub connection, you can use the low-level <a href="/twitch-pubsub-client/classes/PubSubClient.html">PubSubClient</a> for that.</p><p>First, you have to create and instance and connect the client to Twitch&#x27;s PubSub interface:</p><pre style="display:block;overflow-x:auto;padding:0.5em;background:#2b2b2b;color:#bababa"><code><span style="color:#cb7832">import</span> { PubSubClient } <span style="color:#cb7832">from</span> <span style="color:#6a8759">&#x27;twitch-pubsub-client&#x27;</span>;

<span style="color:#cb7832">const</span> client = <span style="color:#cb7832">new</span> PubSubClient();
<span style="color:#cb7832">await</span> client.connect();
</code></pre><p>Next, you have to set up an event listener so you can react to any events you listen to:</p><pre style="display:block;overflow-x:auto;padding:0.5em;background:#2b2b2b;color:#bababa"><code>client.onMessage(<span>(<span style="color:#b9b9b9">topic: <span style="color:#e0c46c">string</span>, message: PubSubMessageData</span>) =&gt;</span> {
	<span style="color:#cb7832">const</span> [kind, userId] = topic.split(<span style="color:#6a8759">&#x27;.&#x27;</span>, <span style="color:#6896ba">2</span>);

	<span style="color:#cb7832">if</span> (kind === <span style="color:#6a8759">&#x27;channel-subscribe-events-v1&#x27;</span>) {
		<span style="color:#cb7832">const</span> subMessage = message <span style="color:#cb7832">as</span> PubSubSubscriptionMessageData;
		<span style="color:#cb7832">if</span> (subMessage.context === <span style="color:#6a8759">&#x27;subgift&#x27;</span>) {
			<span style="color:#e0c46c">console</span>.log(<span style="color:#6a8759">`<span style="color:#e0c46c">${subMessage.display_name}</span> just gifted a subscription to <span style="color:#e0c46c">${subMessage.recipient_display_name}</span>!`</span>);
		}
	}
});
</code></pre><p>Then you can listen to any topic you want:</p><pre style="display:block;overflow-x:auto;padding:0.5em;background:#2b2b2b;color:#bababa"><code><span style="color:#cb7832">const</span> accessToken = <span style="color:#6a8759">&#x27;abc123&#x27;</span>;
<span style="color:#cb7832">await</span> client.listen(<span style="color:#6a8759">`channel-subscribe-events-v1.<span style="color:#e0c46c">${userId}</span>`</span>, accessToken);
</code></pre><p>Please note that if you don&#x27;t listen to any topic in the first 15 seconds after connecting, Twitch will close the connection.</p><p>Later, you can stop listening to any events you&#x27;re listening to again:</p><pre style="display:block;overflow-x:auto;padding:0.5em;background:#2b2b2b;color:#bababa"><code><span style="color:#cb7832">await</span> client.unlisten(<span style="color:#6a8759">`channel-subscribe-events-v1.<span style="color:#e0c46c">${userId}</span>`</span>);
</code></pre></div></main></div></div></div>
</body>
</html>